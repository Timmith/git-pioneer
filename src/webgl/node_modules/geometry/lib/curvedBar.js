var three = require("three");
var geometryUtils = require("geometry/utils");

var __geoms = {};
function curvedBar(geom, angle = Math.PI * 0.4, offsetZ = 0) {
	var hash = Array.prototype.join.call(arguments, ";");
	if(!__geoms[hash]) {
		geom = geom || new three.CylinderGeometry(0.05, 0.1, 0.4, 12, 4);
		var position = new three.Vector3(0.05, 0, offsetZ);
		var orientation = new three.Euler(Math.PI, Math.PI * 0.5, 0);
		geom.vertices.forEach(geometryUtils.bend(position, orientation, angle, 0.4));
		geom.computeVertexNormals();
		geom.computeFaceNormals();
		__geoms[hash] = geom;
	}

	return __geoms[hash];
}


module.exports = curvedBar;